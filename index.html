<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Guante Blanco</title>

  <!-- Fuentes Cinzel y Cinzel Decorative -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel&family=Cinzel+Decorative&display=swap" rel="stylesheet">

  <!-- CSS -->
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- MENÚ SUPERIOR -->
  <header class="header" id="header">
    <nav class="nav">
      <div class="menu-toggle" id="menu-toggle">&#9776;</div>
      <ul class="menu">
        <li><a href="#hero">Inicio</a></li>
        <li><a href="#servicios">Servicios</a></li>
        <li><a href="#modo-operar">Modo de operar</a></li>
        <li><a href="#localizacion">Localización</a></li>
        <li><a href="#ofertas">Ofertas</a></li>
        <li><a href="#agenda">Agenda</a></li>
        <li><a href="#contacto">Contacto</a></li>
      </ul>
    </nav>
  </header>

  <!-- HERO FULLSCREEN -->
  <section class="hero fade-slide" id="hero">
    <img src="images/logo.png" alt="Logo Guante Blanco" class="logo-hero">
  </section>

  <!-- TEXTO DE PRESENTACIÓN -->
  <section class="presentacion fade-slide">
    <p>cuida de lo que te mueve</p>
  </section>

  <!-- CONTENIDO PRINCIPAL -->
  <div class="main-content">

    <!-- SECCIÓN SERVICIOS -->
    <section class="servicios fade-slide" id="servicios">
      <h2>SERVICIOS</h2>
      <img src="images/services.png" alt="Listado de servicios de limpieza de coches" class="imagen-seccion hover-zoom">
    </section>

    <!-- NUEVA SECCIÓN MODO DE OPERAR -->
    <section class="modo-operar fade-slide" id="modo-operar">
      <h2>Modo de operar</h2>
      <div class="form-toggle">
        <button class="toggle-btn">Ver detalles</button>
        <div class="toggle-form">
          <p>- En casa: Si su vehículo se encuentra en una cochera, recinto o lugar privado. Se realizarán los servicios ahí bajo autorización del propietario.</p>
          <p>- Con llaves: En caso de no disponer de un lugar privado para hacer el servicio, el limpiador llevará el vehículo a una instalación local de nuestros socios para realizar el servicio, y una vez acabado se dejará en un punto de recogida acordado. (Queda sujeta una tarifa de 5€ por viaje y la opción de repostar combustible como servicio gratis (con la cuantía de repostaje previamente pagada en mano)).</p>
          <p>En ambos modos contamos con un seguro que cubre cualquier caso que ocurra durante el proceso laboral.</p>
        </div>
      </div>
    </section>

    <!-- SECCIÓN LOCALIZACIÓN -->
    <section class="localizacion fade-slide" id="localizacion">
      <h2>LOCALIZACIÓN</h2>
      <img src="images/mapa.png" alt="Mapa de localización" class="imagen-seccion mapa">
    </section>

    <!-- SECCIÓN OFERTAS -->
    <section class="ofertas fade-slide" id="ofertas">
      <h2>OFERTAS VIGENTES</h2>
      <img src="images/offers.png" alt="Ofertas vigentes" class="imagen-seccion hover-zoom">
    </section>

    <!-- SECCIÓN AGENDA -->
    <section class="agenda fade-slide" id="agenda">
      <h2>AGENDA UNA CITA</h2>

      <!-- FORMULARIO PEDIR CITA -->
      <div class="form-toggle">
        <button class="toggle-btn">Pedir una cita</button>
        <form class="toggle-form" id="form-cita" action="https://formsubmit.co/ae11fd4ef1d5609b19290bf8958a1ba1" method="POST">
          <input type="hidden" name="_captcha" value="false">
          <input type="hidden" name="_subject" value="Nueva solicitud de cita">
          <input type="hidden" name="_template" value="table">
          <!-- Campo honeypot para spam -->
          <input type="text" name="_honey" style="display:none">
          <!-- Campo de timestamp -->
          <input type="hidden" name="_timestamp" value="">

          <input type="text" name="nombre" placeholder="Nombre y apellidos" required minlength="2" maxlength="100">
          <input type="email" name="email" placeholder="Correo electrónico" required>
          <input type="tel" name="telefono" placeholder="Número de teléfono" required pattern="[0-9]{9}" title="Por favor, introduce un número de teléfono válido (9 dígitos)">
          <input type="text" name="modelo" placeholder="Modelo de vehículo" required minlength="2" maxlength="50">
          <input type="text" name="direccion" placeholder="Dirección donde se realizará el servicio" required minlength="5" maxlength="200">

          <!-- NUEVO CAMPO: Modo de operar -->
          <fieldset>
            <legend>Modo de operar</legend>
            <label><input type="radio" name="modo_operar" value="En casa" required> En casa</label><br>
            <label><input type="radio" name="modo_operar" value="Con llave"> Con llave</label>
          </fieldset>
          
          <label for="fecha">Selecciona la fecha deseada:</label>
          <input type="date" name="fecha" id="fecha" required>

          <fieldset>
            <legend>Turno preferente</legend>
            <label><input type="radio" name="turno" value="Mañana" required> Mañana</label><br>
            <label><input type="radio" name="turno" value="Tarde"> Tarde</label><br>
            <label><input type="radio" name="turno" value="Especificado en mensaje"> Especificado en mensaje</label>
          </fieldset>

          <fieldset>
            <legend>Servicios solicitados</legend>
            <label><input type="checkbox" name="servicios[]" value="Exterior básico"> Exterior básico</label><br>
            <label><input type="checkbox" name="servicios[]" value="Interior básico"> Interior básico</label><br>
            <label><input type="checkbox" name="servicios[]" value="Pack básico"> Pack básico</label><br>
            <label><input type="checkbox" name="servicios[]" value="Desodorización/ozono"> Desodorización/ozono</label><br>
            <label><input type="checkbox" name="servicios[]" value="Tratamiento plásticos exteriores"> Tratamiento plásticos exteriores</label><br>
            <label><input type="checkbox" name="servicios[]" value="Restauración de faros"> Restauración de faros</label><br>
            <label><input type="checkbox" name="servicios[]" value="Tapicerías profundo"> Tapicerías profundo</label><br>
            <label><input type="checkbox" name="servicios[]" value="Revitalización de cuero"> Revitalización de cuero</label>
          </fieldset>

          <p>Si deseas usar alguna de las ofertas vigentes, especifícamelo en el mensaje.</p>
          <textarea name="mensaje" rows="4" placeholder="Mensaje adicional (opcional)" maxlength="500"></textarea>
          <button type="submit" id="submit-cita">Pedir una cita</button>
          <p class="mensaje-exito" id="mensaje-cita">El correo ha sido enviado y puesto en cola de revisión, le responderemos lo antes posible.</p>
        </form>
      </div>

      <!-- CALENDARIO DINÁMICO -->
      <div id="calendario-container">
        <div id="calendario"></div>
      </div>
    </section>

    <!-- SECCIÓN CONTACTO -->
    <section class="contacto fade-slide" id="contacto">
      <h2>CONTACTO</h2>
      <div class="form-toggle">
        <button class="toggle-btn">Vía e-mail</button>
        <form class="toggle-form" id="form-contacto" action="https://formsubmit.co/c7e333301c7758a6d44f87a1eac2cc9d" method="POST">
          <input type="hidden" name="_captcha" value="false">
          <input type="hidden" name="_subject" value="Nuevo mensaje de contacto">
          <input type="hidden" name="_template" value="table">
          <!-- Campo honeypot para spam -->
          <input type="text" name="_honey" style="display:none">
          <!-- Campo de timestamp -->
          <input type="hidden" name="_timestamp" value="">

          <input type="text" name="nombre" placeholder="Nombre y apellidos" required minlength="2" maxlength="100">
          <input type="email" name="email" placeholder="Correo electrónico" required>
          <textarea name="mensaje" rows="4" placeholder="Mensaje" required minlength="10" maxlength="1000"></textarea>
          <button type="submit" id="submit-contacto">Enviar</button>
          <p class="mensaje-exito" id="mensaje-contacto">El correo ha sido enviado y puesto en cola de revisión, le responderemos lo antes posible.</p>
        </form>
      </div>
      <p class="redes">
        <a href="https://www.instagram.com/guanteblancoofficial/" target="_blank">Instagram</a> |
        <a href="https://wa.me/34644591350" target="_blank">WhatsApp</a> |
        <a href="tel:+34644591350">Llamar</a>
      </p>
    </section>

  </div>

  <!-- BOTÓN SUBIR -->
  <button id="scrollTopBtn" title="Volver arriba">↑</button>

  <!-- SCRIPT PARA FORMULARIOS, MENÚ, ANIMACIONES Y CALENDARIO -->
  <script>
    // Variables globales para las fechas del calendario
    let fechaMinima = '';
    let fechaMaxima = '';
    const diasOcupados = {
      "2025-11-01": "lleno",
      "2025-11-03": "lleno",
      "2025-11-04": "lleno",
      "2025-11-05": "lleno",
      "2025-11-06": "lleno",
      "2025-11-07": "lleno",
      "2025-11-08": "lleno",
      "2025-11-10": "lleno",
      "2025-11-11": "lleno",
      "2025-11-12": "lleno",
      "2025-11-13": "lleno",
      "2025-11-14": "lleno",
      "2025-11-15": "lleno"
    };

    // Toggle formularios
    const toggleButtons = document.querySelectorAll('.toggle-btn');
    toggleButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const form = btn.nextElementSibling;
        form.classList.toggle('active');
        btn.textContent = form.classList.contains('active')
          ? 'Cerrar'
          : btn.closest('.agenda') ? 'Pedir una cita' : 'Ver detalles';
      });
    });

    // Fade-slide al hacer scroll
    const faders = document.querySelectorAll('.fade-slide');
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if(entry.isIntersecting) {
          entry.target.classList.add('visible');
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.1 });
    faders.forEach(f => observer.observe(f));

    // Validación mejorada de formularios
    function validarFormularioCita() {
      const form = document.getElementById('form-cita');
      const fechaInput = document.getElementById('fecha');
      const servicios = form.querySelectorAll('input[name="servicios[]"]:checked');
      const modo = form.querySelectorAll('input[name="modo_operar"]:checked');

      // Validar que al menos un servicio esté seleccionado
      if (servicios.length === 0) {
        alert('Por favor, selecciona al menos un servicio.');
        return false;
      }

      // Validar que se haya seleccionado modo de operar
      if (modo.length === 0) {
        alert('Por favor, selecciona un modo de operar.');
        return false;
      }
      
      // Validar fecha
      if (fechaInput.value) {
        const fechaSeleccionada = new Date(fechaInput.value);
        const hoy = new Date();
        hoy.setHours(0, 0, 0, 0);
        
        const fechaStr = fechaInput.value;
        if (diasOcupados[fechaStr]) {
          alert('Lo sentimos, la fecha seleccionada ya está ocupada. Por favor, elige otra fecha.');
          return false;
        }
        if (fechaSeleccionada < new Date(fechaMinima) || fechaSeleccionada > new Date(fechaMaxima)) {
          alert('Por favor, selecciona una fecha que aparezca en el calendario.');
          return false;
        }
      }
      return true;
    }

    function validarFormularioContacto() {
      const form = document.getElementById('form-contacto');
      const mensaje = form.querySelector('textarea[name="mensaje"]');
      if (mensaje.value.trim().length < 10) {
        alert('Por favor, escribe un mensaje más detallado (mínimo 10 caracteres).');
        return false;
      }
      return true;
    }

    // Formularios submit con validación mejorada
    function manejarFormulario(formId, mensajeId, validacionFunc) {
      const form = document.getElementById(formId);
      const mensaje = document.getElementById(mensajeId);
      const submitBtn = form.querySelector('button[type="submit"]');

      form.addEventListener('submit', e => {
        e.preventDefault();
        
        const timestampInput = form.querySelector('input[name="_timestamp"]');
        if (timestampInput) timestampInput.value = Date.now();
        
        const honeyInput = form.querySelector('input[name="_honey"]');
        if (honeyInput && honeyInput.value !== '') {
          mensaje.textContent = 'Mensaje enviado (simulado para bots)';
          mensaje.classList.add('visible');
          form.reset();
          setTimeout(() => mensaje.classList.remove('visible'), 3000);
          return;
        }
        
        if (validacionFunc && !validacionFunc()) return;
        
        submitBtn.disabled = true;
        submitBtn.textContent = 'Enviando...';
        
        fetch(form.action, { method: 'POST', body: new FormData(form) })
        .then(() => {
          mensaje.classList.add('visible');
          form.reset();
          setTimeout(() => {
            mensaje.classList.remove('visible');
            submitBtn.disabled = false;
            submitBtn.textContent = formId === 'form-cita' ? 'Pedir una cita' : 'Enviar';
          }, 5000);
        })
        .catch(() => {
          alert('Hubo un error al enviar el formulario. Inténtalo de nuevo más tarde.');
          submitBtn.disabled = false;
          submitBtn.textContent = formId === 'form-cita' ? 'Pedir una cita' : 'Enviar';
        });
      });
    }

    // CALENDARIO MEJORADO
    function generarCalendario() {
      const calendario = document.getElementById('calendario');
      calendario.innerHTML = '';
      const hoy = new Date();
      const añoActual = hoy.getFullYear();
      const mesActual = hoy.getMonth();
      const meses = [];
      for (let i = 0; i < 2; i++) {
        const mesIndex = mesActual + i;
        const año = añoActual + Math.floor(mesIndex / 12);
        const mes = mesIndex % 12;
        meses.push({ año, mes });
      }

      const primerMes = new Date(meses[0].año, meses[0].mes, 1);
      const ultimoMes = new Date(meses[1].año, meses[1].mes + 1, 0);
      fechaMinima = primerMes.toISOString().split('T')[0];
      fechaMaxima = ultimoMes.toISOString().split('T')[0];

      const fechaInput = document.getElementById('fecha');
      if (fechaInput) {
        fechaInput.min = fechaMinima;
        fechaInput.max = fechaMaxima;
      }

      meses.forEach(({año, mes}, i) => {
        const fecha = new Date(año, mes, 1);
        const nombreMes = fecha.toLocaleString('es-ES', { month: 'long' });
        const titulo = document.createElement('div');
        titulo.className = 'mes-calendario';
        titulo.textContent = `${nombreMes.toUpperCase()} ${año}`;
        calendario.appendChild(titulo);

        const diasSemana = ['L','M','X','J','V','S','D'];
        diasSemana.forEach(d => {
          const diaSemana = document.createElement('div');
          diaSemana.className = 'dia dia-semana';
          diaSemana.textContent = d;
          calendario.appendChild(diaSemana);
        });

        const primerDia = fecha.getDay() === 0 ? 6 : fecha.getDay()-1;
        for(let j=0;j<primerDia;j++){
          const blank = document.createElement('div');
          blank.className = 'dia';
          calendario.appendChild(blank);
        }

        const ultimoDia = new Date(año, mes + 1, 0).getDate();
        for(let d=1; d<=ultimoDia; d++){
          const diaDiv = document.createElement('div');
          diaDiv.className = 'dia';
          const fechaStr = `${año}-${String(mes + 1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
          diaDiv.textContent = d;
          const fechaDia = new Date(año, mes, d);
          if(fechaDia < hoy) diaDiv.classList.add('ayer');
          if(diasOcupados[fechaStr] && fechaDia >= hoy) diaDiv.classList.add('lleno');
          calendario.appendChild(diaDiv);
        }

        if (i === 0) {
          const espacio = document.createElement('div');
          espacio.className = 'espacio-entre-meses';
          calendario.appendChild(espacio);
        }
      });
    }

    document.addEventListener('DOMContentLoaded', function() {
      generarCalendario();
      manejarFormulario('form-cita', 'mensaje-cita', validarFormularioCita);
      manejarFormulario('form-contacto', 'mensaje-contacto', validarFormularioContacto);
    });

    document.querySelectorAll('.nav a').forEach(link => {
      link.addEventListener('click', e => {
        e.preventDefault();
        document.querySelector(link.getAttribute('href')).scrollIntoView({ behavior: 'smooth' });
        if(window.innerWidth < 768) document.querySelector('.menu').classList.remove('active');
      });
    });

    const header = document.getElementById('header');
    const heroHeight = document.querySelector('.hero').offsetHeight;
    window.addEventListener('scroll', () => {
      if(window.scrollY > heroHeight - 10) header.classList.add('visible');
      else header.classList.remove('visible');

      const btn = document.getElementById('scrollTopBtn');
      btn.style.display = (window.scrollY > 300) ? 'block' : 'none';
    });

    document.getElementById('scrollTopBtn').addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    document.getElementById('menu-toggle').addEventListener('click', () => {
      document.querySelector('.menu').classList.toggle('active');
    });
  </script>
</body>
</html>
